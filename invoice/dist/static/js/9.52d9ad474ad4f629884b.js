webpackJsonp([9],{"97Gl":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("3cXf"),a=i.n(s),o=i("aMQM"),n=i("wSez"),l={data:function(){return{actions:[{name:"拍"},{name:"照"}],sending:!1,type:this.$route.query.type,username:"",popupVisible:!1,options:[{label:"企业/单位",value:"1"},{label:"个人",value:"2"}],info:{type:"1",compName:"company",number:"6666",tel:"18766666666",name:"user",email:"user@qq.com",moreInfo:{address:"",moreTel:"",bank:"",bankId:""}},infoFake:{token:"",deviceCoding:"",invoiceType:"",headType:"1",invoiceHead:"",identiNo:"",contents:"*运输服务*客运服务费",amount:"",email:"",address:"",phone:"",bank:"",bankNo:"",mark:"",listdetail:[]}}},filters:{formatMoney:function(e){return"￥"+e.toFixed(2)},stampToDate:function(e){if(!e)return"";var t=new Date(e);return e=t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+(t.getDate()<10?"0"+t.getDate():t.getDate())}},activated:function(){var e=this;this.infoFake.token=this.gData.token,this.infoFake.deviceCoding=this.gData.code,this.infoFake.invoiceType=this.$route.query.type,this.info.moreInfo=this.gData.moreInfo,this.infoFake.address=this.$store.getters.getMoreInfoVuex.address,this.infoFake.phone=this.$store.getters.getMoreInfoVuex.moreTel,this.infoFake.bank=this.$store.getters.getMoreInfoVuex.bank,this.infoFake.bankNo=this.$store.getters.getMoreInfoVuex.bankId,this.infoFake.amount=this.$route.query.fee/100,console.log("activated",""),this.$forceUpdate(),this.$store.getters.getAutoFillVuex&&(this.$indicator.open({text:"获取预填信息...",spinnerType:"fading-circle"}),this.axios.post(this.gData.api+"/invioceController/getInvoicedRecordByUserid?token="+this.gData.token,{}).then(function(t){console.log(t.data),Object(n.Toast)({message:"已帮您填写上次信息",duration:1e3}),e.$indicator.close(),"01"===t.data.respcod&&(console.log(t.data.data),console.log(e.infoFake),e.infoFake.invoiceHead=t.data.data.invoiceHead,e.infoFake.identiNo=t.data.data.identiNo,e.infoFake.email=t.data.data.email)}).catch(function(e){this.$indicator.close(),console.log(e)}))},deactivated:function(){this.popupVisible=!1,this.gData.checked30List=[]},methods:{sendInfo:function(){var e=this;for(var t in this.popupVisible=!this.popupVisible,this.$indicator.open({text:"开票中...",spinnerType:"fading-circle"}),this.sending=!0,this.$store.getters.getListInVuex){var i={};for(var s in this.$store.getters.getListInVuex[t])this.js.transKey(s)&&(i[this.js.transKey(s)]=this.$store.getters.getListInVuex[t][s]);this.infoFake.listdetail[t]=i}this.gData.checked30List=[],this.gData.fakeData?this.axios.get("/static/fakeInvoice30List.json?invoiceType="+this.js.checkNull(this.infoFake.invoiceType)+"&headType="+this.js.checkNull(this.infoFake.headType)+"&invoiceHead="+this.js.checkNull(this.infoFake.invoiceHead)+"&identiNo="+this.js.checkNull(this.infoFake.identiNo)+"&contents="+this.js.checkNull(this.infoFake.contents)+"&amount="+this.js.checkNull(this.infoFake.amount)+"&userid="+this.js.checkNull(this.infoFake.userid)+"&email="+this.js.checkNull(this.infoFake.email)+"&address="+this.js.checkNull(this.infoFake.address)+this.js.checkNull(this.infoFake.phone)+"&phone=&bank="+this.js.checkNull(this.infoFake.bank)+this.js.checkNull(this.infoFake.bankNo)+"&bankNo=&mark="+this.js.checkNull(this.infoFake.mark)+"&listdetail="+a()(this.js.checkNull(this.infoFake.listdetail)),{}).then(function(t){e.gData.checked30List=[],e.$store.dispatch("resetListInVuex"),e.$store.dispatch("resetMoreInfoVuex"),e.$indicator.close(),"01"===t.data.respcod?(e.$router.push("/makeSuccess"),e.$store.dispatch("setAutoFillVuex",!0)):Object(n.Toast)({message:t.data.respmsg,duration:1e3})}).catch(function(e){this.gData.checked30List=[],this.$indicator.close(),console.log(e)}):this.$ajax({method:"post",url:this.gData.api+"/invioceController/insertInvoice",headers:{"Content-Type":"application/json;charset=utf-8"},data:{token:this.js.checkNull(this.gData.token),deviceCoding:this.js.checkNull(this.gData.code),invoiceType:this.js.checkNull(this.infoFake.invoiceType),headType:this.js.checkNull(this.infoFake.headType),invoiceHead:this.js.checkNull(this.infoFake.invoiceHead),identiNo:this.js.checkNull(this.infoFake.identiNo),contents:this.js.checkNull(this.infoFake.contents),amount:this.js.checkNull(this.infoFake.amount),email:this.js.checkNull(this.infoFake.email),address:this.js.checkNull(this.infoFake.address)+this.js.checkNull(this.infoFake.phone),phone:"",bank:this.js.checkNull(this.infoFake.bank)+this.js.checkNull(this.infoFake.bankNo),bankNo:"",mark:this.js.checkNull(this.infoFake.mark),listdetail:this.js.checkNull(this.infoFake.listdetail)}}).then(function(t){e.$indicator.close(),e.sending=!1,"01"===t.data.respcod?(e.$store.dispatch("resetListInVuex"),e.$store.dispatch("resetMoreInfoVuex"),e.$router.replace("/makeSuccess"),console.log("开票成功返回01",t.data.respmsg)):(console.log("不成功!==01",t.data.respmsg),Object(n.Toast)({message:"开票失败 请返回重试",duration:2e3}))}).catch(function(e){this.$indicator.close(),this.sending=!1,console.log(e)})},checkInfo:function(){for(var e in this.infoFake)if(this.infoFake[e]){if(/<|>|"|'|&/g.test(this.infoFake[e]))return Object(n.Toast)({message:this.js.checkFill(e)+"有误，请确认",duration:1e3}),!1;if("email"===e&&!/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/.test(this.infoFake[e]))return Object(n.Toast)({message:this.js.checkFill(e)+"有误，请确认",duration:1e3}),!1;if("identiNo"===e&&!/^[^_IOZSVa-z\W]{2}\d{6}[^_IOZSVa-z\W]{10}$/g.test(this.infoFake[e]))return Object(n.Toast)({message:"请输入正确的18位"+this.js.checkFill(e),duration:1e3}),!1}else if("address"!==e&&"bank"!==e&&"bankNo"!==e&&"mark"!==e&&"phone"!==e&&"token"!==e&&"deviceCoding"!==e){if("identiNo"===e&&2===Number(this.infoFake.headType))continue;return console.log("未填",e),void Object(n.Toast)({message:"请输入："+this.js.checkFill(e),duration:1e3})}this.popupVisible=!this.popupVisible,2===Number(this.infoFake.headType)&&(this.infoFake.identiNo="")}},components:{invoiceHeader:o.a}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("invoiceHeader",{attrs:{titleName:e.$t("main.fillMake")}}),e._v(" "),i("div",{staticClass:"fillForm"},[e.gData.debug?i("div",{staticStyle:{"font-size":"16px"}},[e._v(e._s(e.infoFake)),i("br")]):e._e(),e._v(" "),e.gData.debug?i("div",{staticStyle:{"font-size":"16px"}},[e._v("----getListInVuex: "+e._s(e.$store.getters.getListInVuex))]):e._e(),e._v(" "),e.gData.debug?i("div",{staticStyle:{"font-size":"16px"}},[e._v("----listdetail: "+e._s(e.infoFake.listdetail))]):e._e(),e._v(" "),e.gData.debug?i("div",{staticStyle:{"font-size":"16px"}},[e._v("----getMoreInfoVuex: "+e._s(e.$store.getters.getMoreInfoVuex))]):e._e(),e._v(" "),e.gData.debug?i("div",{staticStyle:{"font-size":"16px"}},[e._v("----autoFillVuex: "+e._s(e.$store.getters.getAutoFillVuex))]):e._e(),e._v(" "),i("div",{staticClass:"formItem"},[i("mt-cell",{attrs:{title:"抬头类型"}},[i("mt-radio",{attrs:{options:e.options},model:{value:e.infoFake.headType,callback:function(t){e.$set(e.infoFake,"headType",t)},expression:"infoFake.headType"}})],1)],1),e._v(" "),i("div",{staticClass:"formItem"},[i("mt-field",{attrs:{label:"发票抬头",placeholder:"填写发票抬头"},model:{value:e.infoFake.invoiceHead,callback:function(t){e.$set(e.infoFake,"invoiceHead",t)},expression:"infoFake.invoiceHead"}})],1),e._v(" "),1===Number(e.infoFake.headType)?i("div",{staticClass:"formItem"},[i("mt-field",{attrs:{label:"纳税人识别号",placeholder:"填写纳税人识别号"},model:{value:e.infoFake.identiNo,callback:function(t){e.$set(e.infoFake,"identiNo",t)},expression:"infoFake.identiNo"}})],1):e._e(),e._v(" "),i("div",{staticClass:"formItem"},[i("mt-cell",{attrs:{title:"发票内容",value:e.infoFake.contents}})],1),e._v(" "),i("div",{staticClass:"formItem"},[i("mt-cell",{attrs:{title:"发票金额",value:e.infoFake.amount+" 元"}})],1),e._v(" "),i("div",{staticClass:"formItem"},[i("router-link",{attrs:{to:"/fillMore"}},[i("mt-cell",{attrs:{title:"更多信息",value:"填写备注、地址等(非必填)","is-link":""}})],1)],1),e._v(" "),i("div",{},[i("mt-field",{attrs:{label:"电子邮箱",placeholder:"用于向您发送电子发票"},model:{value:e.infoFake.email,callback:function(t){e.$set(e.infoFake,"email",t)},expression:"infoFake.email"}})],1),e._v(" "),i("mt-popup",{staticClass:"checkList startPop",attrs:{position:"bottom"},model:{value:e.popupVisible,callback:function(t){e.popupVisible=t},expression:"popupVisible"}},[i("div",[i("div",{staticClass:"popHead"},[e._v("确认开票信息")]),e._v(" "),i("div",{staticClass:"hr"}),e._v(" "),i("div",{staticClass:"popCon"},[i("div",{staticClass:"popInfo"},[e._v("发票开具成功后不可撤销，请您仔细核对开票信息")]),e._v(" "),i("mt-cell",{attrs:{title:"发票类型",value:1===Number(e.infoFake.invoiceType)?"电子发票":"纸质发票"}}),e._v(" "),i("mt-cell",{attrs:{title:"抬头类型",value:e.options[0].value==e.infoFake.headType?e.options[0].label:e.options[1].label}}),e._v(" "),i("mt-cell",{attrs:{title:"发票抬头",value:e.infoFake.invoiceHead}}),e._v(" "),1===Number(e.infoFake.headType)?i("mt-cell",{attrs:{title:"纳税人识别号",value:e.infoFake.identiNo}}):e._e(),e._v(" "),i("mt-cell",{attrs:{title:"发票金额",value:e.infoFake.amount+" 元"}}),e._v(" "),i("mt-cell",{attrs:{title:"电子邮件",value:e.infoFake.email}}),e._v(" "),i("div",{on:{click:e.sendInfo}},[i("mt-button",{staticClass:"mainButton",attrs:{type:"default"}},[e._v("确认")])],1)],1)])]),e._v(" "),i("div",[i("mt-button",{staticClass:"mainButton",attrs:{type:"default"},on:{click:e.checkInfo}},[e._v("提交")])],1),e._v(" "),i("div",{staticClass:"spaceBottom24"})],1)],1)},staticRenderFns:[]};var h=i("C7Lr")(l,c,!1,function(e){i("F+uE")},"data-v-4da62d4f",null);t.default=h.exports},"F+uE":function(e,t){}});